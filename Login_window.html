<!DOCTYPE html>
<html lang="en">
<head>
     <!-- Required meta tags -->
     <meta charset="utf-8">
     <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 
     <!-- Bootstrap CSS -->
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
     <link rel="icon" href="logo_canteen.png">
     <link rel="stylesheet" href="login_window.css">
     <link rel="stylesheet" href="new_index.css">
     <title>Signup</title>
    <script>
        function redirectToCustomer(){
        document.getElementById("btn1").style.display = "none";
        document.getElementById("btn2").style.display = "none";
        document.getElementById("no_account").style.display = "none";
        document.getElementById("no_account").style.display = "none";
        document.getElementById("field_customer").style.display = "block";
        document.getElementById('phn_sign').style.display = 'none'; 

    }
      function redirectToCanteenOwner(){
        document.getElementById('phn_sign').style.display = 'none'; 

        document.getElementById("btn1").style.display = "none";
          document.getElementById("btn2").style.display = "none";
          document.getElementById("no_account").style.display = "none";
          document.getElementById("no_account").style.display = "none";
          document.getElementById("field_owner").style.display = "block";
      }
    </script>
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/6.0.1/firebase-ui-auth.css" />
</head>
<body id="mybody">
    <nav class="navbar navbar-dark bg-dark" style="position: fixed;top:0px;width: 100%;z-index: 1;overflow: visible;">
        <div class="nav nav-tabs" id="nav-tab" role="tablist" style="z-index: 1;">
          <a class="nav-item nav-link" id="nav-home-tab" data-toggle="tab" href="index.html" role="tab" aria-controls="nav-home" aria-selected="true">Home</a>
          <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="canteen_Status.html" role="tab" aria-controls="nav-profile" aria-selected="false">View Canteen Status</a>
          <a class="nav-item nav-link active" id="nav-contact-tab" data-toggle="tab" href="Login_window.html" role="tab" aria-controls="nav-contact" aria-selected="false">Login</a>
          <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="sign_up_window.html" role="tab" aria-controls="nav-contact" aria-selected="false">SignUP</a>
          <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" role="tab" aria-controls="nav-contact" aria-selected="false" style="color: #007BFF;cursor: pointer;" href="contact.html">Contact Us</a>
        </div>

       
        <img src="theme.png" alt="" style="height: 30px;width: 30px;margin-left: 10cm;background-color: black;cursor: pointer;" onclick="document.getElementById('light_theme').style.display ='block';document.getElementsByTagName('BODY')[0].style.backgroundColor='black';" title="Click here to switch to dark theme" id="dark_mode">
      
        <img src="light_theme.png" alt="" style="height: 30px;width: 50px;margin-left: 0cm;background-color: black;cursor: pointer;" onclick="document.getElementsByTagName('BODY')[0].style.backgroundColor='lightgrey';" title="Click here to switch to light theme" id="light_mode">
        <h1 style="float: right;font-family:cursive;color: white;margin-right: 2mm;font-size: 50px;" id="Dine_desk_contact">Dine Desk</h1>
       
    </nav>


    <br><br><br>  
   
       <button type="button" onclick="redirectToCustomer();"  id="btn1">Login as a customer</button>
       <button type="button" onclick="redirectToCanteenOwner();" id="btn2">Login as a Canteen Owner</button>
         
        
<!--        
       
       <fieldset style="background-color: black; width: 400px; display: none;margin: auto; margin-top: 4cm;" id="field_customer">
        <legend style="background-color: orange; border: solid 0.2cm brown; margin-left: 3cm;">Login as a Customer</legend>
    <div style="background-color: gray; width: 400px; padding: 8px; margin-left: 0%; margin-top: 10px;" >
    <form action="" autocomplete="on" style="background-color: gray; width: 400px;" id="contactForm">
    
    
        <label for="email2" style="background: none;">Email :: </label>
        <input type="email" id="email2" style="background-color: white; margin-left: 63px;" > <br> <br>
    
    <label for="Pass2" style="background-color: gray;">Enter password ::</label>
    <input type="password" name="pass" id="Pass2" style="margin-left: 2px; background-color: white;" ><br> <br>

    <button type="submit" value="submit" id="signin_c" title="Click to sign-in">Log in</button>
    </form></div></fieldset> -->

    
    
<fieldset style="background: url(wallPAPER.jpg) ;margin-top: 3cm;margin-left: 10cm;height: 280px;width: 590px;background-position-x: 0.4cm;background-position-y: 10cm;display: none;" class="rounded" id="field_customer">
    <form id="contactForm" action="" style="margin-left: 0.7cm;margin-top: 0.7cm;">
        <div class="form-group">
          <label for="email2" style="color: white;margin-left: 2mm;">Email address</label>
          <input type="email" class="form-control" id="email2" placeholder="Enter email" style="width: 500px;margin-left: 2mm;">
          <small id="emailHelp" class="form-text text-muted" style="margin-left: 2mm;color: rgb(255, 255, 255) !important;">We'll never share your email with anyone else.</small>
        </div>
        <div class="form-group">
          <label for="Pass2" style="margin-left: 2mm;color: white">Password</label>
          <input type="password" class="form-control" id="Pass2" placeholder="Password" style="width: 500px;margin-left: 2mm;" required>
        </div>
      
        <button type="submit" class="btn btn-primary" style="margin-left: 5cm;" id="signin_c" title="Click to sign-up" value="submit">sign in</button>
        
        <a href="Login_window.html" title="Click to go back to login page" class="btn btn-primary" style="margin-left: 5mm;">Back</a>
    </form>
</fieldset>


<!-- 
       <fieldset style="background-color: black; width: 400px; display: none;margin: auto; margin-top: 4cm;" id="field_owner">
                <legend style="background-color: orange; border: solid 0.2cm brown; margin-left: 3cm;">Login as a Canteen Owner</legend>
            <div style="background-color: gray; width: 400px; padding: 8px; margin-left: 0%; margin-top: 10px;" >
            <form action="" autocomplete="on" style="background-color: gray; width: 400px;" id="contactForm">
            
            
                <label for="email" style="background: none;">Email :: </label>
                <input type="email" id="email" style="background-color: white; margin-left: 63px;" > <br> <br>
            
            <label for="Pass" style="background-color: gray;">Enter password ::</label>
            <input type="password" name="pass" id="Pass" style="margin-left: 2px; background-color: white;" ><br> <br>
        
            <button type="submit" value="submit" id="signin" title="Click to sign-in">Log in</button>
        </form></div></fieldset> -->
        
           
    
<fieldset style="background: url(wallPAPER.jpg) ;margin-top: 3cm;margin-left: 10cm;height: 280px;width: 590px;background-position-x: 0.4cm;background-position-y: 10cm;display: none;" class="rounded" id="field_owner">
    <form id="contactForm" action="" style="margin-left: 0.7cm;margin-top: 0.7cm;">
        <div class="form-group">
          <label for="email" style="color: white;margin-left: 2mm;">Email address</label>
          <input type="email" class="form-control" id="email" placeholder="Enter email" style="width: 500px;margin-left: 2mm;">
          <small id="emailHelp" class="form-text text-muted" style="margin-left: 2mm;color: rgb(255, 255, 255) !important;">We'll never share your email with anyone else.</small>
        </div>
        <div class="form-group">
          <label for="Pass" style="margin-left: 2mm;color: white">Password</label>
          <input type="password" class="form-control" id="Pass" placeholder="Password" style="width: 500px;margin-left: 2mm;" required>
        </div>
      
        <button type="submit" class="btn btn-primary" style="margin-left: 5cm;" id="signin" title="Click to sign-up" value="submit">sign in</button>
        
        <a href="Login_window.html" title="Click to go back to login page" class="btn btn-primary" style="margin-left: 5mm;">Back</a>
    </form>
</fieldset> 
       

<div class="card" style="width: 18rem;" id="phn_sign" >
    <div class="card-body">
      <h5 class="card-title">Not Signed up yet?</h5>
      <p class="card-text">Signup on our website to take advantages of great features.
      </p>
      <a href="sign_up_window.html" class="card-link" style="margin-left: 2cm;"><b> Sign-up</b></a>
    
    </div>
  </div>
    


    <fieldset id="no_account">
   <p style="text-align: center;font-size: 20px;">Don't have an account yet?</p> 
   <a href="sign_up_window.html"> <button type="button" >Sign up</button></a>   
       

</form></div></fieldset>
        <h1 id="secretCode" style="text-align: center;">Authentication Complete</h1>
       <a href="#"> <h1 style="font-size: 20px; margin-top: 7cm;margin-left: 520px;background-color: aquamarine;color: rgb(202, 33, 33);background: none;display: none;text-decoration: underline;" id="update_status" >Update your Canteen Status !</h1>
       </a>

       <a href="canteen_Status.html"> <h1 class="rounded" style="color:white;text-decoration: none;text-align: center;" id="view_status" >View Canteen Status</h1>
       </a>
        
<div  id="updating_stats">
        <h2 style="margin-left:3.5cm;">Update Canteen Status</h2>
       
        <fieldset style="width: 400px;margin:auto;height: 60px;margin-top: 1cm;">
            <legend style="background-color: rgb(255, 124, 124); color:black; font-size: 15px; padding: 0.7%;">Canteen Name</legend>
            
            <input type="text" name="user_name" id="user_name" style="align-items: center;margin-left: -4px;width: 100%;height: 30px;" required>
        </fieldset>
       
        <fieldset style="width: 400px;margin:auto;height: 60px;margin-top: 1cm;">
            <legend style="background-color: rgb(255, 124, 124); color:black; font-size: 15px; padding: 0.7%;">Email ID of Owner</legend>
            
            <input type="email" name="update_email" id="updating_email" style="align-items: center;margin-left: -4px;width: 100%;height: 30px;" required>
        </fieldset>  



        <fieldset style="width: 200px;height: 60px;margin-top: 1cm;margin-left: 3cm;">
            <legend style="background-color: rgb(255, 124, 124); color:black; font-size: 15px; padding: 0.7%;">Update Status</legend>
        <select name="open/closed" id="new_status" style="margin-left: 0.75cm;margin-top: 0.25cm;" >
            <option value="select" >--select--</option>
            <option value="open">Open</option>
            <option value="closed">Closed</option>
        </select>

        </fieldset>  
        <button type="submit" value="Update" id="update_me" title="Click to sign-in" style="margin-top: 0.5cm;margin-left: 5.5cm;">Update</button>
</div>

<div id="viewstatus">
    <h3 style="margin-left: 11%;font-size: 40px;">View Live Canteen Status</h3>
    <a href="canteen_Status.html"><button type="button" title="click to view status" style="background-color: lightgrey;margin-left: 43%;border-radius: 10%;background-color: rgb(65, 114, 156);margin-bottom: 3%;font-size: 30px;cursor: pointer;">View</button></a>
</div>

<a href="register_your_canteen.html" style="text-decoration: none;">
<button type="button" id="reg_update" style="text-decoration: none;margin-top: 1%;margin-left: 42.5%;" class="rounded" >
    Register your Canteen
    </button> </a>
<button type="button" id="btn_update" style="margin-top: 2mm;" class="rounded">
UPDATE YOUR CANTEEN STATUS
</button>






<script type="module">
            document.getElementById("field_customer").addEventListener('submit',(event)=>{
            event.preventDefault()
           })
           document.getElementById("field_owner").addEventListener('submit',(event)=>{
            event.preventDefault()
           })
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
            import { getDatabase, ref, get,set,child, update } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-database.js";
            import { getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut} from "https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries
          
            // Your web app's Firebase configuration
            // For Firebase JS SDK v7.20.0 and later, measurementId is optional
            const firebaseConfig = {
                apiKey: "AIzaSyBf_inD4Hqb2zqkmCuha69YEEgZ0EvSdDI",
            authDomain: "canteen-live-status-65e71.firebaseapp.com",
             databaseURL: "https://canteen-live-status-65e71-default-rtdb.firebaseio.com",
            projectId: "canteen-live-status-65e71",
            storageBucket: "canteen-live-status-65e71.appspot.com",
            messagingSenderId: "427128725985",
            appId: "1:427128725985:web:161d9f41d3e126af35b2a0",
            measurementId: "G-YH01SPNTT2"
            };
          
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);
            const database = getDatabase(app);
            const auth= getAuth();
            const updating_stats = document.getElementById('updating_stats');
            const letsSignOut = document.getElementById('signOut');
            const authform = document.getElementById('field_owner');
            const secretCode = document.getElementById('secretCode');
            const fieldUP = document.getElementById('field');
            const update_status = document.getElementById("update_status");
            const view_status = document.getElementById("view_status");
            const register_hide = document.getElementById('nav_btn2');
            const nav_btn1 = document.getElementById('nav_btn1');    
            const field_customer = document.getElementById('field_customer');                   
            const phn_sign = document.getElementById('phn_sign');
 
signin_c.addEventListener('click', (e)=>{
    var email__ = document.getElementById('email2').value;
    var Pass__ = document.getElementById('Pass2').value;
   
    signInWithEmailAndPassword(auth, email__, Pass__)
  .then((userCredential) => { 
    // Signed in 
    const user = userCredential.user;
     alert('WeLCOME ' + email__);
     secretCode.style.display= 'block';
     view_status.style.display = 'block';
      
         // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    alert(errorCode + errorMessage);
})}
)

signin.addEventListener('click', (e)=>{
    var email__ = document.getElementById('email').value;
    var Pass__ = document.getElementById('Pass').value;
   
    signInWithEmailAndPassword(auth, email__, Pass__)
  .then((userCredential) => { 
    // Signed in 
    const user = userCredential.user;
     alert('WeLCOME ' + email__);
     secretCode.style.display = 'block';
     authform.style.display = 'none'; 
     document.getElementById('reg_update').style.display = 'block';
     document.getElementById('btn_update').style.display = 'block';

         // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;
    alert(errorCode + errorMessage);
})}
)

const dbRef = ref(getDatabase());

function checking() {get(child(dbRef, `users/` + document.getElementById('user_name').value) + "/email").then((snapshot) => {
  if(snapshot.val()==document.getElementById('updating_email').value){
   console.log("correct email id");
  }
  else {
    console.log("No data available");
  }
}).catch((error) => {
  console.error("error_cateen_name_Wala");
});
}
function UpdateData(){
    
    update(ref(database, "users/" + document.getElementById('user_name').value ),{

       status:  document.getElementById('new_status').value,  
    })
    .then(()=>{
        alert("data updated successfully");
        document.getElementById('updating_stats').style.display = 'none';
    document.getElementById('viewstatus').style.display= 'block';

    })
    .catch((error)=>{
        alert("please try again" + "error :" + errorCode);
    });
}

update_me.addEventListener('click', checking);
update_me.addEventListener('click', UpdateData);



document.getElementById('btn_update').addEventListener('click', (e)=>{
    document.getElementById("btn_update").style.display = 'none';
    document.getElementById("reg_update").style.display = 'none';
    document.getElementById("secretCode").style.display = 'none';
    document.getElementById('updating_stats').style.display= 'block';
    document.getElementById('updating_stats').style.marginTop= '4cm';

  

})

</script>

<div><h1></h1></div>
</body>
</html>